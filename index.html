<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åœ†ç›˜æŠ½å¥–å™¨</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Microsoft YaHei", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 600px;
        width: 100%;
      }

      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
        font-size: 28px;
      }

      .question-input {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 40px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .question-text {
        font-size: 24px;
        color: #333;
      }

      .question-input input {
        font-size: 24px;
        padding: 10px 15px;
        border: 2px solid #667eea;
        border-radius: 8px;
        outline: none;
        width: 120px;
        transition: border-color 0.3s;
      }

      .question-input input:focus {
        border-color: #764ba2;
      }

      .wheel-container {
        position: relative;
        width: 400px;
        height: 400px;
        margin: 0 auto 30px;
      }

      .wheel {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        position: absolute;
        top: 0;
        left: 0;
        border: 8px solid #333;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        transition: transform 3s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        background: conic-gradient(
          #ffe66d 0deg 120deg,
          #4ecdc4 120deg 240deg,
          #ff6b6b 240deg 360deg
        );
      }

      .section-text {
        position: absolute;
        font-size: 36px;
        font-weight: bold;
        color: #333;
        text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
        z-index: 10;
        pointer-events: none;
        white-space: nowrap;
      }

      .section-text-1 {
        /* ä¸åš - åœ¨é¡¶éƒ¨ */
        top: 15%;
        left: 50%;
        transform: translateX(-50%);
      }

      .section-text-2 {
        /* å¯èƒ½åš - å³ä¸‹ */
        bottom: 25%;
        right: 15%;
      }

      .section-text-3 {
        /* åš - å·¦ä¸‹ */
        bottom: 25%;
        left: 15%;
      }

      .pointer {
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 20px solid transparent;
        border-right: 20px solid transparent;
        border-top: 40px solid #333;
        z-index: 100;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
      }

      .spin-button {
        display: block;
        margin: 0 auto;
        padding: 15px 40px;
        font-size: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      }

      .spin-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
      }

      .spin-button:active {
        transform: translateY(0);
      }

      .spin-button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .result {
        text-align: center;
        margin-top: 20px;
        font-size: 24px;
        font-weight: bold;
        color: #333;
        min-height: 40px;
      }

      @media (max-width: 600px) {
        .wheel-container {
          width: 300px;
          height: 300px;
        }

        .wheel-section {
          font-size: 24px;
        }

        .question-text {
          font-size: 20px;
        }

        .question-input input {
          font-size: 20px;
          width: 100px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¯ åœ†ç›˜æŠ½å¥–å™¨</h1>

      <div class="question-input">
        <span class="question-text">æˆ‘è¦å»</span>
        <input type="text" id="questionInput" />
        <span class="question-text">å—ï¼Ÿ</span>
      </div>

      <div class="wheel-container">
        <div class="wheel" id="wheel"></div>
        <div class="pointer"></div>
        <div class="section-text section-text-1">ä¸åš</div>
        <div class="section-text section-text-2">å¯èƒ½åš</div>
        <div class="section-text section-text-3">åš</div>
      </div>

      <button class="spin-button" id="spinButton">å¼€å§‹æŠ½å¥–</button>

      <div class="result" id="result"></div>
    </div>

    <script>
      const wheel = document.getElementById("wheel");
      const spinButton = document.getElementById("spinButton");
      const result = document.getElementById("result");
      let isSpinning = false;

      // è®¡ç®—æ—‹è½¬è§’åº¦ï¼Œç¡®ä¿æŒ‡é’ˆå§‹ç»ˆæŒ‡å‘"ä¸åš"
      // é»„è‰²åŒºåŸŸï¼ˆ"ä¸åš"ï¼‰åœ¨0-120åº¦ï¼Œä½äºé¡¶éƒ¨
      // æŒ‡é’ˆå›ºå®šåœ¨é¡¶éƒ¨ï¼Œæ‰€ä»¥æ—‹è½¬åéœ€è¦è®©é»„è‰²åŒºåŸŸå›åˆ°é¡¶éƒ¨
      // åŒæ—¶ç¡®ä¿åˆ†ç•Œçº¿ï¼ˆ0åº¦ã€120åº¦ã€240åº¦ï¼‰ä¸åœ¨æŒ‡é’ˆå·¦å³20åº¦å†…
      function spinWheel() {
        if (isSpinning) return;

        isSpinning = true;
        spinButton.disabled = true;
        result.textContent = "";

        // è·å–å½“å‰æ—‹è½¬è§’åº¦ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
        const currentRotation = getCurrentRotation();

        // ç”Ÿæˆéšæœºæ—‹è½¬åœˆæ•°ï¼ˆ3-8åœˆï¼‰
        const randomSpins = 3 + Math.random() * 5;

        // è®¡ç®—åŸºç¡€è§’åº¦ï¼šè®©é»„è‰²åŒºåŸŸå›åˆ°é¡¶éƒ¨
        // é»„è‰²åŒºåŸŸåœ¨0-120åº¦ï¼Œæˆ‘ä»¬éœ€è¦æ—‹è½¬åˆ°360åº¦çš„å€æ•°
        const baseAdjustment = (360 - (currentRotation % 360)) % 360;

        // ä¸ºäº†é¿å…åˆ†ç•Œçº¿åœ¨æŒ‡é’ˆÂ±20åº¦å†…ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªåç§»
        // åˆ†ç•Œçº¿åœ¨ï¼š0åº¦ã€120åº¦ã€240åº¦
        // å¦‚æœåœ†ç›˜æ—‹è½¬Xåº¦ï¼Œåˆ†ç•Œçº¿ä¼šåœ¨ï¼šXåº¦ã€X+120åº¦ã€X+240åº¦
        // è¦é¿å…åˆ†ç•Œçº¿åœ¨é¡¶éƒ¨ï¼ˆ0åº¦ï¼‰çš„Â±20åº¦å†…ï¼Œéœ€è¦ï¼š
        // - X % 360 ä¸åœ¨ [-20, 20] æˆ– [340, 360] èŒƒå›´å†…
        // - (X + 120) % 360 ä¸åœ¨ [-20, 20] æˆ– [340, 360] èŒƒå›´å†…
        // - (X + 240) % 360 ä¸åœ¨ [-20, 20] æˆ– [340, 360] èŒƒå›´å†…
        // åŒæ—¶è¦è®©é»„è‰²åŒºåŸŸï¼ˆ0-120åº¦ï¼‰åœ¨é¡¶éƒ¨ï¼Œå³Xåº”è¯¥åœ¨-120åˆ°0åº¦ä¹‹é—´ï¼ˆæˆ–240-360åº¦ï¼‰
        // é€‰æ‹©-100åˆ°-20åº¦ä¹‹é—´çš„éšæœºè§’åº¦ï¼Œè¿™æ ·ï¼š
        // - 0åº¦åˆ†ç•Œçº¿ä¼šåœ¨-100åˆ°-20åº¦ï¼ˆä¸åœ¨Â±20åº¦å†…ï¼‰
        // - 120åº¦åˆ†ç•Œçº¿ä¼šåœ¨20åˆ°100åº¦ï¼ˆä¸åœ¨Â±20åº¦å†…ï¼‰
        // - 240åº¦åˆ†ç•Œçº¿ä¼šåœ¨140åˆ°220åº¦ï¼ˆä¸åœ¨Â±20åº¦å†…ï¼‰
        // - é»„è‰²åŒºåŸŸä¼šåœ¨-100åˆ°20åº¦ï¼ŒåŒ…å«é¡¶éƒ¨
        const safeOffset = 20 + Math.random() * 80; // 20-100åº¦ï¼Œå–è´Ÿå€¼

        const totalRotation =
          currentRotation + randomSpins * 360 + baseAdjustment - safeOffset;

        wheel.style.transform = `rotate(${totalRotation}deg)`;

        // 3ç§’åæ˜¾ç¤ºç»“æœ
        setTimeout(() => {
          result.textContent = "ç»“æœï¼šä¸åšï¼";
          isSpinning = false;
          spinButton.disabled = false;
        }, 3000);
      }

      // è·å–å½“å‰æ—‹è½¬è§’åº¦
      function getCurrentRotation() {
        const style = window.getComputedStyle(wheel);
        const matrix =
          style.transform || style.webkitTransform || style.mozTransform;

        if (matrix === "none" || !matrix) {
          return 0;
        }

        const values = matrix.split("(")[1].split(")")[0].split(",");
        const a = values[0];
        const b = values[1];
        const angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));

        return angle < 0 ? angle + 360 : angle;
      }

      spinButton.addEventListener("click", spinWheel);

      // å›è½¦é”®ä¹Ÿå¯ä»¥è§¦å‘
      document
        .getElementById("questionInput")
        .addEventListener("keypress", (e) => {
          if (e.key === "Enter" && !isSpinning) {
            spinWheel();
          }
        });
    </script>
  </body>
</html>
